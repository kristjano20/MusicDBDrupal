<?php

use Drupal\Core\Form\FormStateInterface;

/**
 * Adds Spotify autocomplete to artist title field.
 */
function musicsearch_form_node_form_alter(array &$form, FormStateInterface $form_state, string $form_id): void {
  $node = $form_state->getFormObject()->getEntity();
  if ($node->bundle() !== 'artist') {
    return;
  }

  if (!isset($form['title']['widget'][0]['value'])) {
    return;
  }

  $title_element = &$form['title']['widget'][0]['value'];
  $title_element['#autocomplete_route_name'] = 'musicsearch.spotify_artist_autocomplete';
  $title_element['#autocomplete_route_parameters'] = [];
  $title_element['#description'] = t('Start typing to search Spotify and pick the correct artist.');
}

